import pandas as pd

#############################################
# Get the Protein Intersection of two drugs #
#ä###########################################

# Read the CSV file into a DataFrame
#louvain_gdsc1 = {'1001': 0, '1004': 1, '1005': 1, '1006': 1, '1007': 0, '1010': 0, '1011': 0, '1012': 0, '1013': 2, '1014': 2, '1015': 2, '1016': 1, '1017': 1, '1018': 0, '1019': 0, '1021': 1, '1022': 1, '1024': 1, '1026': 2, '1029': 1, '1030': 1, '1031': 1, '1032': 0, '1033': 2, '1036': 2, '1037': 1, '1038': 1, '1039': 1, '104': 3, '1043': 1, '1046': 1, '1047': 2, '1048': 2, '1049': 1, '1050': 1, '1052': 1, '1053': 3, '1054': 1, '1057': 3, '1058': 3, '1059': 2, '106': 0, '1060': 2, '1061': 2, '1062': 2, '1066': 3, '1069': 0, '1091': 1, '11': 0, '1114': 0, '1133': 1, '1135': 1, '1136': 3, '1142': 1, '1149': 1, '1166': 3, '1170': 0, '1175': 1, '1184': 1, '1185': 3, '119': 0, '1192': 1, '1194': 2, '1219': 0, '1230': 0, '1236': 1, '1239': 1, '1241': 1, '1242': 2, '1243': 1, '1248': 0, '1259': 1, '1261': 4, '1262': 1, '1266': 3, '1268': 0, '127': 1, '133': 0, '134': 2, '135': 2, '136': 1, '1371': 2, '1372': 2, '1373': 2, '1374': 2, '1375': 3, '1376': 1, '1377': 0, '1378': 1, '1382': 0, '1386': 1, '1392': 1, '1393': 1, '1394': 1, '1401': 3, '1402': 1, '1403': 1, '1407': 3, '1409': 3, '1413': 0, '1414': 0, '1416': 0, '1419': 1, '1421': 1, '1422': 1, '1425': 3, '1426': 1, '1427': 0, '1428': 0, '1429': 0, '1430': 1, '1432': 1, '1434': 3, '1436': 0, '1441': 3, '1444': 3, '1445': 0, '1446': 0, '1451': 1, '1453': 2, '1458': 1, '1459': 1, '1460': 1, '1461': 0, '1463': 3, '1464': 1, '1494': 1, '1495': 1, '1496': 1, '1497': 1, '1498': 2, '1502': 3, '1515': 3, '1516': 1, '1518': 2, '1520': 0, '1525': 0, '1526': 2, '1527': 3, '153': 3, '1535': 0, '154': 1, '1543': 1, '1544': 1, '1546': 1, '1547': 1, '155': 1, '156': 3, '159': 3, '163': 0, '165': 1, '166': 3, '167': 2, '17': 0, '170': 4, '171': 0, '172': 0, '173': 2, '176': 1, '177': 0, '179': 3, '180': 3, '182': 0, '186': 3, '190': 0, '192': 3, '194': 3, '196': 1, '199': 1, '200': 1, '201': 0, '204': 0, '205': 0, '207': 0, '211': 0, '219': 0, '221': 1, '222': 1, '223': 1, '224': 2, '225': 0, '226': 2, '228': 1, '229': 1, '230': 1, '235': 1, '236': 3, '245': 0, '249': 3, '252': 1, '254': 0, '255': 1, '256': 1, '257': 2, '261': 0, '262': 2, '263': 1, '264': 3, '265': 0, '268': 1, '269': 2, '275': 0, '276': 0, '277': 3, '279': 4, '281': 1, '282': 0, '284': 3, '285': 0, '286': 3, '288': 0, '29': 2, '290': 0, '292': 0, '293': 3, '294': 3, '295': 2, '3': 0, '300': 2, '301': 2, '302': 1, '304': 0, '306': 1, '308': 1, '309': 1, '310': 0, '312': 1, '317': 0, '32': 3, '326': 1, '329': 1, '330': 2, '331': 0, '34': 2, '341': 2, '342': 1, '344': 0, '345': 2, '346': 3, '35': 0, '356': 1, '362': 1, '363': 1, '366': 1, '37': 0, '371': 0, '372': 3, '374': 0, '376': 0, '38': 3, '380': 0, '381': 0, '406': 2, '407': 2, '408': 2, '409': 2, '412': 3, '416': 1, '427': 2, '428': 2, '431': 2, '432': 2, '435': 2, '436': 1, '437': 3, '438': 3, '439': 0, '442': 0, '446': 1, '447': 2, '449': 3, '45': 0, '461': 3, '474': 2, '476': 3, '477': 1, '478': 1, '5': 0, '51': 3, '52': 5, '53': 0, '54': 0, '546': 0, '55': 0, '552': 1, '56': 3, '562': 0, '563': 2, '574': 0, '576': 1, '59': 0, '62': 0, '63': 0, '71': 0, '83': 0, '86': 0, '9': 3, '94': 3}
louvain_gdsc2 = {'1003': 0, '1004': 0, '1005': 1, '1006': 1, '1007': 2, '1008': 2, '1010': 0, '1011': 1, '1012': 2, '1013': 1, '1014': 1, '1016': 5, '1017': 1, '1019': 0, '1021': 1, '1022': 1, '1023': 0, '1024': 5, '1026': 1, '1030': 2, '1032': 0, '1034': 2, '1036': 1, '1037': 1, '1038': 2, '1042': 2, '1046': 2, '1047': 0, '1048': 6, '1049': 5, '1050': 2, '1051': 1, '1052': 2, '1053': 5, '1054': 2, '1056': 1, '1057': 5, '1058': 0, '1060': 1, '1061': 1, '1062': 1, '1064': 2, '1067': 2, '1068': 0, '1069': 2, '1072': 2, '1073': 0, '1074': 2, '1078': 7, '1079': 0, '1080': 2, '1081': 5, '1082': 2, '1083': 2, '1084': 5, '1085': 2, '1086': 1, '1088': 1, '1089': 2, '1090': 1, '1091': 0, '1092': 0, '1093': 2, '1094': 0, '1096': 1, '1149': 2, '1168': 0, '1169': 1, '1179': 1, '1190': 0, '1191': 1, '1192': 1, '1193': 2, '1194': 2, '1200': 2, '1237': 2, '1239': 2, '1248': 1, '1250': 1, '1259': 1, '1372': 1, '1373': 1, '1375': 2, '1494': 2, '1506': 1, '1507': 1, '1510': 2, '1511': 0, '1512': 2, '1514': 3, '1529': 1, '1549': 0, '1553': 5, '1557': 2, '1558': 0, '1559': 2, '1560': 0, '1561': 0, '1563': 2, '1564': 1, '1593': 1, '1594': 5, '1598': 2, '1616': 2, '1630': 3, '1632': 2, '1635': 6, '1735': 1, '1786': 0, '1787': 2, '1793': 1, '1794': 2, '1799': 0, '1850': 2, '1851': 2, '1857': 1, '1858': 0, '1862': 0, '1864': 2, '1867': 2, '1872': 1, '1873': 0, '1908': 1, '1909': 1, '1910': 1, '1911': 5, '1912': 5, '1913': 2, '1915': 0, '1916': 5, '1917': 2, '1918': 5, '1919': 0, '1922': 5, '1923': 0, '1924': 5, '1925': 2, '1926': 5, '1927': 2, '1928': 2, '1929': 2, '1930': 2, '1931': 2, '1932': 2, '1933': 2, '1934': 2, '1936': 0, '1937': 2, '1938': 5, '1939': 0, '1940': 2, '1941': 0, '1944': 2, '1945': 0, '1946': 2, '1949': 2, '1954': 2, '1956': 2, '1957': 0, '1958': 1, '1959': 0, '1960': 1, '1961': 0, '1962': 5, '1964': 4, '1965': 2, '1966': 2, '1968': 1, '1970': 1, '1971': 0, '1972': 1, '1973': 0, '1975': 1, '1980': 2, '1982': 2, '1985': 2, '1986': 2, '1987': 0, '1989': 7, '1990': 2, '1991': 0, '1997': 0, '2013': 2, '2014': 0, '2016': 2, '2018': 2, '2020': 0, '2021': 0, '2022': 0, '2023': 1, '2024': 2, '2026': 2, '2027': 2, '2028': 2, '2034': 1, '2040': 5, '2041': 2, '2042': 2, '2043': 2, '2044': 1, '2045': 2, '2046': 2, '2047': 2, '2048': 2, '2063': 1, '2066': 0, '2071': 2, '2074': 0, '2075': 0, '2076': 1, '2077': 2, '2078': 2, '2080': 2, '2081': 2, '2084': 2, '2090': 0, '2093': 5, '2096': 1, '2097': 0, '2103': 5, '2105': 1, '2106': 5, '2107': 2, '2108': 2, '2109': 0, '2110': 2, '2111': 2, '2125': 2, '2127': 2, '2150': 5, '2151': 1, '2153': 2, '2160': 1, '2161': 2, '2162': 1, '2163': 1, '2164': 2, '2170': 5, '2171': 2, '2176': 2, '2178': 1, '2182': 2, '2184': 1, '2220': 2, '2235': 2, '2243': 2, '2252': 1, '2253': 0, '2255': 2, '2256': 2, '2257': 1, '2261': 1, '2268': 2, '2270': 2, '2271': 0, '2272': 1, '2273': 1, '2274': 1, '2279': 2, '2281': 2, '2282': 2, '2283': 2, '2284': 5, '2290': 2, '2291': 2, '2293': 2, '2294': 1, '2295': 0, '2296': 1, '2298': 2, '2300': 2, '2303': 2, '2305': 2, '2306': 2, '2308': 2, '2309': 1, '2312': 1, '2315': 2, '2316': 5, '2317': 2, '2319': 1, '2323': 0, '2324': 2, '2325': 2, '2326': 1, '2327': 2, '2328': 1, '2331': 2, '2333': 2, '2354': 2, '2365': 2, '2460': 2, '2466': 2, '2504': 2, '2505': 1, '2508': 1, '2509': 0}
louvain_gdsc1_resolution_15 ={'1026': 0, '1374': 0, '376': 0, '226': 0, '29': 0, '249': 0, '1048': 0, '1498': 0, '1060': 0, '563': 0, '427': 0, '1014': 0, '407': 0, '257': 0, '1013': 0, '1033': 0, '438': 0, '134': 0, '135': 0, '1526': 0, '34': 0, '262': 0, '435': 0, '264': 0, '1372': 0, '1059': 0, '1062': 0, '1015': 0, '437': 0, '1453': 0, '345': 0, '300': 0, '431': 0, '1133': 1, '1066': 1, '1053': 1, '476': 1, '1241': 1, '1016': 1, '1444': 1, '156': 1, '1057': 1, '1243': 1, '1036': 2, '1061': 2, '167': 2, '1242': 2, '374': 2, '245': 2, '1373': 2, '1371': 2, '1047': 2, '1018': 3, '1413': 3, '201': 3, '1414': 3, '1268': 3, '285': 3, '439': 3, '1429': 3, '207': 3, '133': 3, '86': 3, '37': 3, '1427': 3, '171': 3, '182': 3, '304': 3, '17': 3, '54': 3, '71': 3, '1230': 3, '1535': 3, '1428': 3, '3': 3, '11': 3, '59': 3, '1461': 3, '1382': 3, '5': 3, '55': 3, '53': 3, '35': 3, '1219': 3, '1520': 3, '106': 3, '45': 3, '1007': 3, '326': 4, '329': 4, '1516': 4, '1043': 4, '1030': 4, '223': 4, '1038': 4, '1046': 4, '1496': 4, '302': 4, '1149': 4, '1262': 4, '256': 4, '1017': 4, '235': 4, '1460': 4, '1495': 4, '1543': 4, '1259': 4, '1547': 4, '1376': 4, '1142': 4, '342': 4, '1459': 4, '1494': 4, '446': 4, '1184': 4, '1546': 4, '1544': 4, '1052': 4, '1006': 4, '228': 4, '1031': 4, '1419': 4, '229': 4, '1050': 4, '1394': 4, '1175': 4, '1039': 4, '176': 4, '1005': 4, '1426': 4, '268': 4, '1451': 4, '1392': 5, '1458': 5, '1386': 5, '1378': 5, '1393': 5, '200': 6, '180': 6, '204': 6, '186': 6, '1502': 6, '173': 6, '177': 6, '1401': 7, '172': 7, '205': 7, '346': 8, '474': 8, '269': 8, '301': 8, '252': 8, '432': 8, '219': 8, '1029': 9, '436': 9, '199': 9, '1037': 9, '1135': 9, '312': 9, '286': 9, '263': 9, '1497': 9, '221': 9, '1421': 9, '154': 9, '136': 9, '1091': 9, '478': 9, '1192': 9, '127': 9, '1432': 9, '1422': 9, '1236': 9, '277': 9, '1024': 9, '1021': 9, '1136': 9, '155': 9, '230': 9, '281': 9, '309': 9, '179': 9, '1049': 9, '1425': 10, '1261': 10, '1409': 10, '279': 10, '284': 10, '461': 10, '412': 10, '449': 10, '294': 10, '576': 10, '372': 10, '293': 10, '194': 10, '1185': 10, '170': 10, '1434': 10, '1266': 10, '1515': 10, '236': 10, '1004': 10, '1239': 10, '1375': 10, '1001': 11, '276': 11, '275': 11, '292': 11, '1436': 11, '290': 11, '1069': 11, '261': 11, '1019': 11, '211': 11, '546': 11, '254': 11, '344': 11, '1170': 11, '295': 11, '225': 11, '380': 11, '310': 11, '265': 11, '190': 11, '562': 11, '317': 11, '1058': 11, '1525': 11, '574': 11, '1464': 12, '1407': 12, '1054': 12, '32': 12, '38': 12, '255': 13, '1430': 13, '196': 13, '552': 13, '477': 13, '428': 13, '366': 13, '362': 13, '306': 13, '308': 13, '416': 13, '1402': 13, '1403': 13, '222': 13, '363': 13, '165': 13, '1022': 13, '1194': 13, '381': 13, '63': 14, '104': 14, '1011': 14, '1012': 14, '83': 14, '1527': 14, '1441': 14, '163': 14, '1166': 14, '62': 14, '94': 14, '9': 14, '192': 14, '288': 15, '356': 15, '1445': 15, '341': 15, '1416': 15, '1446': 15, '447': 15, '442': 15, '119': 15, '331': 15, '1032': 15, '1518': 15, '408': 15, '1114': 15, '1010': 15, '330': 15, '224': 15, '409': 15, '371': 15, '1248': 15, '1377': 15, '406': 15, '282': 15, '52': 16, '51': 17, '1463': 17, '159': 17, '153': 17, '56': 17, '166': 17}
louvain_gdsc2_resolution_15 ={'1036': 0, '1972': 0, '1857': 0, '2047': 0, '2151': 0, '1037': 0, '1975': 0, '2252': 0, '1373': 0, '1872': 0, '1250': 0, '2076': 0, '1372': 0, '2063': 0, '1061': 0, '1060': 0, '1970': 0, '1014': 0, '2272': 0, '1056': 0, '1062': 0, '1968': 0, '2508': 0, '2296': 0, '1908': 0, '2096': 0, '1564': 0, '2034': 0, '1169': 0, '1090': 0, '2312': 0, '1023': 1, '1786': 1, '1936': 1, '1960': 1, '1934': 2, '2309': 3, '1078': 3, '1989': 3, '1026': 3, '1514': 4, '2160': 4, '1630': 4, '1048': 5, '1635': 5, '1918': 6, '1926': 6, '1053': 6, '1938': 6, '2093': 6, '1191': 6, '1042': 6, '1962': 6, '2316': 6, '1922': 6, '1081': 6, '1916': 6, '1057': 6, '2103': 6, '1047': 6, '2170': 6, '1084': 6, '1594': 6, '1553': 6, '2040': 6, '1912': 6, '2106': 6, '1024': 6, '1016': 6, '1924': 6, '1013': 6, '1958': 6, '1049': 6, '2075': 7, '1560': 7, '2097': 7, '1558': 7, '2271': 7, '2066': 7, '1094': 7, '1862': 7, '1549': 7, '1945': 7, '2090': 7, '2022': 7, '1799': 7, '1919': 7, '1058': 7, '1959': 7, '1092': 7, '2326': 7, '2021': 7, '1991': 7, '1168': 7, '1073': 7, '1003': 7, '1923': 7, '1032': 7, '2253': 7, '1873': 7, '2020': 7, '1019': 7, '1561': 7, '1091': 7, '1511': 7, '2074': 7, '1010': 7, '1068': 7, '1915': 7, '1971': 7, '2014': 7, '2509': 7, '2109': 7, '1939': 8, '1941': 8, '1930': 8, '1089': 9, '1867': 9, '1082': 9, '1632': 9, '2333': 9, '1012': 9, '1052': 9, '2171': 9, '1054': 9, '1964': 10, '1911': 10, '2150': 10, '1034': 10, '1997': 11, '1933': 11, '1011': 11, '1987': 11, '2323': 11, '1858': 11, '1910': 11, '1973': 12, '1957': 12, '1149': 12, '1954': 12, '2016': 12, '1079': 12, '1913': 12, '1237': 12, '2303': 12, '1004': 12, '2295': 12, '1190': 12, '2042': 13, '2308': 13, '1931': 13, '2164': 13, '2107': 13, '1851': 13, '1193': 13, '2182': 13, '1067': 13, '2161': 13, '1038': 13, '2111': 13, '1507': 13, '2048': 13, '2257': 13, '1864': 13, '1083': 13, '2046': 13, '2013': 13, '2110': 13, '2255': 13, '1940': 13, '1932': 13, '1375': 13, '2282': 13, '2176': 13, '1074': 13, '1850': 13, '1563': 13, '2045': 13, '1494': 13, '1080': 13, '1928': 13, '1050': 13, '1917': 13, '2290': 13, '2041': 13, '2243': 13, '1937': 13, '2077': 13, '2300': 13, '1072': 13, '1239': 13, '1944': 13, '2043': 13, '1007': 13, '2127': 14, '2026': 14, '2071': 14, '1966': 14, '1512': 14, '2153': 14, '1030': 14, '2081': 14, '2235': 14, '2504': 14, '2220': 14, '2027': 14, '2354': 14, '2024': 14, '2315': 15, '2325': 15, '2108': 15, '1982': 15, '2028': 15, '1200': 15, '2018': 15, '2078': 15, '1946': 15, '1794': 15, '2291': 15, '1510': 15, '2268': 15, '2084': 15, '2080': 15, '1559': 15, '1093': 15, '2365': 15, '1925': 15, '1598': 15, '2281': 15, '1008': 15, '1965': 15, '1069': 15, '2125': 15, '2331': 15, '1956': 15, '2466': 15, '1927': 15, '1980': 15, '1064': 15, '2305': 15, '2279': 15, '2283': 15, '1986': 15, '2324': 15, '2256': 15, '1194': 15, '1085': 15, '1990': 15, '1985': 15, '2284': 16, '1735': 17, '2270': 17, '2298': 17, '2460': 17, '2294': 17, '2274': 17, '1046': 17, '1793': 17, '1557': 17, '1192': 17, '2184': 17, '2163': 17, '2178': 17, '2273': 17, '2306': 17, '1929': 17, '1949': 17, '1616': 17, '1086': 17, '1787': 17, '2327': 17, '1179': 17, '2317': 17, '1096': 17, '1529': 17, '1593': 17, '2319': 17, '2105': 17, '2044': 17, '2261': 17, '1248': 17, '1022': 17, '2293': 17, '1506': 17, '1088': 18, '2023': 18, '2505': 18, '2162': 18, '1021': 18, '1909': 18, '1005': 18, '1961': 18, '1017': 18, '1051': 18, '1006': 18, '1259': 18, '2328': 18}




def getallValues(drug_id1, drug_id2, dataset):
    df = pd.read_csv('2.csv')
    dataset1 = dataset
    dataset2 = dataset  # Replace with the second dataset you want to search for

    # Filter for the first drug and dataset
    subset1 = df[(df['y_id'].str.split(";").str.get(0) == drug_id1) & (df['y_id'].str.split(";").str.get(2) == dataset1) ]
    # Get the set of proteins for the first drug and dataset
    proteins_set1 = set(subset1['x_id'])

    # Filter for the second drug and dataset
    subset2 = df[(df['y_id'].str.split(";").str.get(0) == drug_id2) & (df['y_id'].str.split(";").str.get(2) == dataset2) ]
    # Get the set of proteins for the second drug and dataset
    proteins_set2 = set(subset2['x_id'])

    # Calculate the number of proteins for each drug
    num_proteins_drug1 = len(proteins_set1)
    num_proteins_drug2 = len(proteins_set2)

    # Calculate the number of proteins in the intersection
    intersection_proteins = proteins_set1.intersection(proteins_set2)
    num_intersection_proteins = len(intersection_proteins)

    # Print the results
    drug_name1 = subset1['y_id'].str.split(";").str.get(1).values[0] if not subset1.empty else None
    drug_target1 = subset1['target'].values[0]
    drug_target2 = subset2['target'].values[0]
    # Get the drug name for the second drug and dataset
    drug_name2 = subset2['y_id'].str.split(";").str.get(1).values[0] if not subset2.empty else None

    # Print the drug names
    print(drug_name1, drug_name2, num_proteins_drug1, num_proteins_drug2, num_intersection_proteins, drug_target1, drug_target2, intersection_proteins)
    return drug_name1, drug_name2, num_proteins_drug1, num_proteins_drug2, num_intersection_proteins, drug_target1, drug_target2

#getallValues('1084', '1016', 'GDSC2')

def getGroupInfo(drug_list, dataset):
    df = pd.read_csv('2.csv')
    protein_count = {}
    for d in drug_list:
        subset1 = df[(df['y_id'].str.split(";").str.get(0) == d) & (df['y_id'].str.split(";").str.get(2) == dataset) ]
        proteins_set1 = set(subset1['x_id'])
        for protein in proteins_set1:
            if protein in protein_count:
                protein_count[protein] += 1
            else:
                protein_count[protein] = 1
    
    # Sort the dictionary by the count of proteins in descending order
    sorted_protein_count = sorted(protein_count.items(), key=lambda x: x[1], reverse=True)
    
    occurrence_count_summary = {}
    
    for protein, count in sorted_protein_count:
        if count in occurrence_count_summary:
            occurrence_count_summary[count].append(protein)
        else:
            occurrence_count_summary[count] = [protein]
    
    # Print the summary
    county = 0
    for count, proteins in occurrence_count_summary.items():
        print(f"Proteins with Occurrence Count {count}: {len(proteins)} proteins")
        print(f"Protein List: {', '.join(proteins)}")
        print()
        break

#getGroupInfo(['1080','1007'], 'GDSC2')
def results_for_communities():
    gdsc = "GDSC2"
    l_group = louvain_gdsc2
    grouped_dict = {}

    for key, value in l_group.items():
        if value in grouped_dict:
            grouped_dict[value].append(key)
        else:
            grouped_dict[value] = [key]    
    for value, keys in grouped_dict.items():
        print("Group: ", value)
        print("´Number of drugs: ", len(keys))
        getGroupInfo(keys, gdsc)
#results_for_communities()
